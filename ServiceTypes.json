{
    "ServiceTypes": [
        {
            "Name": "ExchangeOnPremises",
            "SessionTestCmdlet": "Get-OrganizationConfig",
            "SessionTestCmdletParameters": [],
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [
                {
                    "Name": "PreferredDomainControllers",
                    "type": "string[]",
                    "Mandatory": false,
                    "Value": []
                }
            ],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": true,
            "PSSessionParameters": [
                {
                    "name": "ConnectionURI",
                    "ValueType": "ScriptBlock",
                    "Value": "'http://' + $Endpoint.Address + '/PowerShell/'"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Exchange"
                },
                {
                    "name": "Authentication",
                    "ValueType": "Static",
                    "Value": "Kerberos"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [],
                    "Phase3": [
                        {
                            "conditions": [
                                {
                                    "type": "local",
                                    "test": "($endpoint.ServiceTypeAttributes.PreferredDomainControllers.count -ge 1)"
                                }
                            ],
                            "command": "Set-ADServerSettings",
                            "parameters": [
                                {
                                    "name": "SetPreferredDomainControllers",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$endpoint.ServiceTypeAttributesPreferredDomainControllers"
                                }
                            ]
                        },
                        {
                            "conditions": [],
                            "command": "Set-ADServerSettings",
                            "parameters": [
                                {
                                    "name": "ViewEntireForest",
                                    "ValueType": "Static",
                                    "Value": true
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "Name": "ExchangeOnline",
            "SessionTestCmdlet": "Get-OrganizationConfig",
            "SessionTestCmdletParameters": [],
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": true,
            "WellKnownEndPointURI": "https://outlook.office365.com/powershell-liveid/",
            "WellKnownEndPointAuthMethod": "Basic",
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": true,
            "PSSessionParameters": [
                {
                    "name": "ConnectionURI",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Exchange"
                },
                {
                    "name": "Authentication",
                    "ValueType": "Static",
                    "Value": "Basic"
                },
                {
                    "name": "AllowRedirection",
                    "ValueType": "Static",
                    "Value": true
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [],
                    "Phase3": []
                }
            }
        },
        {
            "Name": "ExchangeComplianceCenter",
            "SessionTestCmdlet": "Get-AdminAuditLogConfig",
            "SessionTestCmdletParameters": [],
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": true,
            "WellKnownEndPointURI": "https://ps.compliance.protection.outlook.com/powershell-liveid/",
            "WellKnownEndPointAuthMethod": "Basic",
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": true,
            "PSSessionParameters": [
                {
                    "name": "ConnectionURI",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Exchange"
                },
                {
                    "name": "Authentication",
                    "ValueType": "Static",
                    "Value": "Basic"
                },
                {
                    "name": "AllowRedirection",
                    "ValueType": "Static",
                    "Value": true
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [],
                    "Phase3": []
                }
            }
        },
        {
            "Name": "Exchange2007",
            "SessionTestCmdlet": "Get-OrganizationConfig",
            "SessionTestCmdletParameters": {
                "ErrorAction": "Stop",
                "WarningAction": "SilentlyContinue"
            },
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": true,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [
                        {
                            "name": "Microsoft.Exchange.Management.PowerShell.Admin",
                            "type": "PSSnapIn"
                        }
                    ],
                    "Phase3": []
                }
            }
        },
        {
            "Name": "PowerShell",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [
                {
                    "name": "SessionManagementGroups",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [],
                    "Phase3": []
                }
            }
        },
        {
            "Name": "PowerShell32",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [
                {
                    "name": "SessionManagementGroups",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell32"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [],
                    "Phase3": []
                }
            }
        },
        {
            "Name": "SQLDatabase",
            "SessionTestCmdlet": "Test-DbaConnection",
            "SessionTestCmdletParameters": [
                {
                    "Name": "SQLInstance",
                    "ValueType": "Static",
                    "Value": "$SQLConnection"
                }
            ],
            "OrgSystemServiceTypeAttributes": [
                {
                    "Name": "DatabaseName",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                },
                {
                    "Name": "SQLServerFQDN",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [
                        {
                            "name": "dbaTools",
                            "type": "module"
                        }
                    ],
                    "Phase3": [
                        {
                            "command":"Connect-DBAInstance",
                            "parameters":[
                                {
                                    "name": "SQLConnectionOnly",
                                    "ValueType":"Static",
                                    "Value" : true
                                },
                                {
                                    "name": "SQLInstance",
                                    "ValueType":"ScriptBlock",
                                    "Value" : "$ServiceObject.ServiceTypeAttributes.SQLServerFQDN"
                                },
                                {
                                    "name": "Database",
                                    "ValueType":"ScriptBlock",
                                    "Value" : "$ServiceObject.ServiceTypeAttributes.DatabaseName"
                                },
                                {
                                    "name": "ClientName",
                                    "ValueType":"Static",
                                    "Value" : "OneShell"
                                },
                                {
                                    "name": "EncryptConnection",
                                    "ValueType":"Static",
                                    "Value" : true
                                },
                                {
                                    "name": "TrustServerCertificate",
                                    "ValueType":"Static",
                                    "Value" : true
                                },
                                {
                                    "name": "OutVariable",
                                    "ValueType":"Static",
                                    "Value" : "SQLConnection"
                                }
                                ,
                                {
                                    "name": "Credential",
                                    "ValueType":"ScriptBlock",
                                    "Value" : "$ServiceObject.Credentials.Service"
                                }
                            ]
                        }
                    ]
                },
                "Import":{
                    "ModulesAndCommands":
                    [
                        {
                            "name": "Invoke-DbaSql*",
                            "type": "Command"
                        }
                    ],
                    "ArbitraryCommands":
                    [
                        {
                            "conditions": [],
                            "command": "Invoke-Expression",
                            "parameters": [
                                {
                                    "name": "command",
                                    "ValueType": "Static",
                                    "Value": "$PSDefaultParameterValues.Add('Invoke-DbaSql*:SQLInstance',$SqlConnection)"
                                }
                            ]
                        }
                    ]

                }
            }
        },
        {
            "Name": "AADSyncServer",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [
                        {
                            "name": "ADSync"
                        }
                    ],
                    "Phase3": []
                }
            }
        },
        {
            "Name": "AzureADPreview",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [
                {
                    "Name": "TenantSubDomain",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [
                        {
                            "name": "AzureADPreview",
                            "type": "module"
                        }
                    ],
                    "Phase3": [
                        {
                            "command": "Connect-AzureAD",
                            "parameters": {
                                "Name": "Credential",
                                "ValueType": "ScriptBlock",
                                "Value": "$ServiceObject.Credentials.Service"
                            }
                        }
                    ]
                }
            }
        },
        {
            "Name": "AzureAD",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [
                {
                    "Name": "TenantSubDomain",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [
                        {
                            "name": "AzureAD"
                        }
                    ],
                    "Phase3": [
                        {
                            "command": "Connect-AzureAD",
                            "parameters": {
                                "Name": "Credential",
                                "ValueType": "ScriptBlock",
                                "Value": "$ServiceObject.Credentials.Service"
                            }
                        }
                    ]
                }
            }
        },
        {
            "Name": "MSOnline",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [
                {
                    "Name": "TenantSubDomain",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [
                        {
                            "name": "MSOnline"
                        }
                    ],
                    "Phase3": [
                        {
                            "command": "Connect-MsolService",
                            "parameters": [
                                {
                                    "Name": "Credential",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$ServiceObject.Credentials.Service"
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "Name": "ActiveDirectoryDomain",
            "SessionTestCmdlet": "Get-ADRootDSE",
            "SessionTestCmdletParameters": [],
            "OrgSystemServiceTypeAttributes": [
                {
                    "Name": "ADUserAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "name": "ADGroupAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "Name": "ADContactAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "Name": "ADDomainFQDN",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                },
                {
                    "Name": "PSDriveName",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [
                        {
                            "Command": "New-Item",
                            "parameters": [
                                {
                                    "Name": "Path",
                                    "ValueType": "Static",
                                    "Value": "Env:\\"
                                },
                                {
                                    "Name": "Name",
                                    "ValueType": "Static",
                                    "Value": "ADPS_LoadDefaultDrive"
                                },
                                {
                                    "Name": "Value",
                                    "ValueType": "Static",
                                    "Value": 0
                                }
                            ]
                        }
                    ],
                    "Phase2_ModuleImport": [
                        {
                            "name": "ActiveDirectory"
                        }
                    ],
                    "Phase3": [
                        {
                            "conditions": [],
                            "command": "New-PSDrive",
                            "parameters": [
                                {
                                    "Name": "Name",
                                    "ValueType": "scriptblock",
                                    "Value": "$ServiceObject.ServiceTypeAttributes.PSDriveName"
                                },
                                {
                                    "Name": "Server",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$ServiceObject.ServiceTypeAttributes.ADDomainFQDN"
                                },
                                {
                                    "Name": "Root",
                                    "ValueType": "Static",
                                    "Value": "//RootDSE/"
                                },
                                {
                                    "Name": "Scope",
                                    "ValueType": "Static",
                                    "Value": "Global"
                                },
                                {
                                    "Name": "PSProvider",
                                    "ValueType": "Static",
                                    "Value": "ActiveDirectory"
                                },
                                {
                                    "Name": "Credential",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$ServiceObject.Credentials.Service"
                                }
                            ]
                        },
                        {
                            "conditions": [],
                            "command": "Set-Location",
                            "parameters": [
                                {
                                    "Name": "Path",
                                    "ValueType": "scriptblock",
                                    "Value": "$ServiceObject.ServiceTypeAttributes.PSDriveName + ':\\'"
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "Name": "ActiveDirectoryGlobalCatalog",
            "SessionTestCmdlet": "Get-ADRootDSE",
            "SessionTestCmdletParameters": [],
            "OrgSystemServiceTypeAttributes": [
                {
                    "Name": "ADUserAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "name": "ADGroupAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "Name": "ADContactAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "Name": "ADForestFQDN",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                },
                {
                    "Name": "PSDriveName",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [
                        {
                            "Command": "New-Item",
                            "parameters": [
                                {
                                    "Name": "Path",
                                    "ValueType": "Static",
                                    "Value": "Env:\\"
                                },
                                {
                                    "Name": "Name",
                                    "ValueType": "Static",
                                    "Value": "ADPS_LoadDefaultDrive"
                                },
                                {
                                    "Name": "Value",
                                    "ValueType": "Static",
                                    "Value": 0
                                }
                            ]
                        }
                    ],
                    "Phase2_ModuleImport": [
                        {
                            "name": "ActiveDirectory"
                        }
                    ],
                    "Phase3": [
                        {
                            "conditions": [],
                            "command": "New-PSDrive",
                            "parameters": [
                                {
                                    "Name": "Name",
                                    "ValueType": "scriptblock",
                                    "Value": "$ServiceObject.ServiceTypeAttributes.PSDriveName"
                                },
                                {
                                    "Name": "Server",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$($ServiceObject.ServiceTypeAttributes.ADForestFQDN + ':3268')"
                                },
                                {
                                    "Name": "Root",
                                    "ValueType": "Static",
                                    "Value": "//RootDSE/"
                                },
                                {
                                    "Name": "Scope",
                                    "ValueType": "Static",
                                    "Value": "Global"
                                },
                                {
                                    "Name": "PSProvider",
                                    "ValueType": "Static",
                                    "Value": "ActiveDirectory"
                                },
                                {
                                    "Name": "Credential",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$ServiceObject.Credentials.Service"
                                }
                            ]
                        },
                        {
                            "conditions": [],
                            "command": "Set-Location",
                            "parameters": [
                                {
                                    "Name": "Path",
                                    "ValueType": "scriptblock",
                                    "Value": "$ServiceObject.ServiceTypeAttributes.PSDriveName + ':\\'"
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "Name": "ActiveDirectoryLDS",
            "SessionTestCmdlet": "Get-ADRootDSE",
            "SessionTestCmdletParameters": [],
            "OrgSystemServiceTypeAttributes": [
                {
                    "Name": "ADUserAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "name": "ADGroupAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "Name": "ADContactAttributes",
                    "type": "string[]",
                    "mandatory": false,
                    "value": []
                },
                {
                    "Name": "PSDriveName",
                    "type": "string",
                    "mandatory": true,
                    "value": ""
                }
            ],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [
                        {
                            "Command": "New-Item",
                            "parameters": [
                                {
                                    "Name": "Path",
                                    "ValueType": "Static",
                                    "Value": "Env:\\"
                                },
                                {
                                    "Name": "Name",
                                    "ValueType": "Static",
                                    "Value": "ADPS_LoadDefaultDrive"
                                },
                                {
                                    "Name": "Value",
                                    "ValueType": "Static",
                                    "Value": 0
                                }
                            ]
                        }
                    ],
                    "Phase2_ModuleImport": [
                        {
                            "name": "ActiveDirectory"
                        }
                    ],
                    "Phase3": [
                        {
                            "conditions": [],
                            "command": "New-PSDrive",
                            "parameters": [
                                {
                                    "Name": "Name",
                                    "ValueType": "scriptblock",
                                    "Value": "$ServiceObject.ServiceTypeAttributes.PSDriveName"
                                },
                                {
                                    "Name": "Server",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$endpoint.Address"
                                },
                                {
                                    "Name": "Root",
                                    "ValueType": "Static",
                                    "Value": "//RootDSE/"
                                },
                                {
                                    "Name": "Scope",
                                    "ValueType": "Static",
                                    "Value": "Global"
                                },
                                {
                                    "Name": "PSProvider",
                                    "ValueType": "Static",
                                    "Value": "ActiveDirectory"
                                },
                                {
                                    "Name": "Credential",
                                    "ValueType": "ScriptBlock",
                                    "Value": "$ServiceObject.Credentials.Service"
                                }
                            ]
                        },
                        {
                            "conditions": [],
                            "command": "Set-Location",
                            "parameters": [
                                {
                                    "Name": "Path",
                                    "ValueType": "scriptblock",
                                    "Value": "$ServiceObject.ServiceTypeAttributes.PSDriveName + ':\\'"
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "Name": "SMTPMailRelay",
            "SessionTestCmdlet": "Send-MailMessage",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": false,
            "PSSessionParameters": [],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [
                        {
                            "Command": "",
                            "parameters": {}
                        }
                    ],
                    "Phase2_ModuleImport": [],
                    "Phase3": [
                        {
                            "command": "",
                            "parameters": {}
                        }
                    ]
                }
            }
        },
        {
            "Name": "SkypeForBusinessOnline",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": true,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [
                {
                    "name": "SkypeOnlineConnector"
                }
            ],
            "PSSessionCmdlet": "New-SkypeOnlinePSSession",
            "PSSessionConstrained": true,
            "PSSessionParameters": [],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [],
                    "Phase3": []
                }
            }
        },
        {
            "Name": "SkypeForBusinessOnPremises",
            "SessionTestCmdlet": "Get-Command",
            "SessionTestCmdletParameters": [
                {
                    "Name": "Name",
                    "ValueType": "Static",
                    "Value": "Get-Command"
                }
            ],
            "OrgSystemServiceTypeAttributes": [],
            "DefaultsToWellKnownEndPoint": false,
            "WellKnownEndPointURI": null,
            "WellKnownEndPointAuthMethod": null,
            "EndPointServiceTypeAttributes": [],
            "PSSessionConnectRequiredModule": [],
            "PSSessionCmdlet": null,
            "PSSessionConstrained": true,
            "PSSessionParameters": [
                {
                    "name": "ComputerName",
                    "ValueType": "ScriptBlock",
                    "Value": "$Endpoint.Address"
                },
                {
                    "name": "ConfigurationName",
                    "ValueType": "Static",
                    "Value": "Microsoft.Powershell"
                }
            ],
            "PSSessionSettings": {
                "Initialization": {
                    "Phase1_PreModuleImport": [],
                    "Phase2_ModuleImport": [],
                    "Phase3": []
                }
            }
        }
    ]
}